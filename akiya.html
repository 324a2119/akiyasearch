import streamlit as st
import pandas as pd

# ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã«ã€Œä½¿ç”¨ç›®çš„ã€ã€Œè¨­å‚™æ¡ä»¶ã€ã‚’è¿½åŠ 
houses = pd.DataFrame([
    {
        "ç‰©ä»¶ID": 1,
        "åœ°åŸŸ": "å¯Œå±±çœŒå¯Œå±±å¸‚",
        "ä¾¡æ ¼": 500,
        "é–“å–ã‚Š": "3LDK",
        "ç¯‰å¹´æ•°": 30,
        "è©³ç´°": "é§…ã‹ã‚‰å¾’æ­©10åˆ†ã®åºƒã€…ã¨ã—ãŸç‰©ä»¶",
        "ä½¿ç”¨ç›®çš„": "å±…ä½ç”¨",
        "è¨­å‚™æ¡ä»¶": ["é§è»Šå ´ã‚ã‚Š", "åº­ä»˜ã"],
        "ç”»åƒURL": "/content/drive/MyDrive/Colab Notebooks/Gemini_Generated_Image_d8vfnfd8vfnfd8vf.jpg"
    },
    {
        "ç‰©ä»¶ID": 2,
        "åœ°åŸŸ": "çŸ³å·çœŒé‡‘æ²¢å¸‚",
        "ä¾¡æ ¼": 300,
        "é–“å–ã‚Š": "2DK",
        "ç¯‰å¹´æ•°": 40,
        "è©³ç´°": "é™ã‹ãªä½å®…è¡—ã«ã‚ã‚‹ä¸­å¤ç‰©ä»¶",
        "ä½¿ç”¨ç›®çš„": "åˆ¥è˜",
        "è¨­å‚™æ¡ä»¶": ["ã‚ªãƒ¼ãƒ«é›»åŒ–"],
        "ç”»åƒURL": "/content/drive/MyDrive/Colab Notebooks/DSC_0412.JPG"
    },
    {
        "ç‰©ä»¶ID": 3,
        "åœ°åŸŸ": "å¯Œå±±çœŒé«˜å²¡å¸‚",
        "ä¾¡æ ¼": 200,
        "é–“å–ã‚Š": "4LDK",
        "ç¯‰å¹´æ•°": 50,
        "è©³ç´°": "ãƒªãƒ•ã‚©ãƒ¼ãƒ æ¸ˆã¿ã€‚å¤§å®¶æ—å‘ã‘",
        "ä½¿ç”¨ç›®çš„": "åº—èˆ—",
        "è¨­å‚™æ¡ä»¶": ["é§è»Šå ´ã‚ã‚Š"],
        "ç”»åƒURL": "/content/drive/MyDrive/Colab Notebooks/DSC_0399.JPG"
    },
])

# ãƒšãƒ¼ã‚¸è¨­å®š
st.set_page_config(page_title="ç©ºãå®¶ã•ãƒ¼ã¡", layout="wide")

# ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆç™½èƒŒæ™¯ãƒ»é»’æ–‡å­—ãƒ»é’è¦‹å‡ºã—ï¼‰
st.markdown("""
    <style>
        body, .stApp {
            background-color: white;
            color: black;
        }
        h1, h2, h3 {
            color: #0A4DA2;
        }
        .stButton>button {
            background-color: #0A4DA2;
            color: white;
        }
        .stButton>button:hover {
            background-color: #083B80;
        }
        .streamlit-expanderHeader {
            color: #0A4DA2;
        }
    </style>
""", unsafe_allow_html=True)

# ã‚¿ã‚¤ãƒˆãƒ«
st.title("ğŸ  ç©ºãå®¶ã•ãƒ¼ã¡")

# ğŸ” ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶
with st.sidebar:
    st.header("ğŸ” çµã‚Šè¾¼ã¿æ¤œç´¢")
    selected_area = st.selectbox("åœ°åŸŸ", ["ã™ã¹ã¦"] + sorted(houses["åœ°åŸŸ"].unique()))
    max_price = st.slider("äºˆç®—ï¼ˆä¸‡å††ï¼‰", min_value=100, max_value=1000, value=600)
    selected_layout = st.selectbox("é–“å–ã‚Š", ["ã™ã¹ã¦"] + sorted(houses["é–“å–ã‚Š"].unique()))
    selected_usage = st.selectbox("ä½¿ç”¨ç›®çš„", ["ã™ã¹ã¦"] + sorted(houses["ä½¿ç”¨ç›®çš„"].unique()))
    selected_features = st.multiselect("è¨­å‚™æ¡ä»¶ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰", ["é§è»Šå ´ã‚ã‚Š", "åº­ä»˜ã", "ã‚ªãƒ¼ãƒ«é›»åŒ–"])

# ğŸ” ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å‡¦ç†
filtered = houses.copy()
if selected_area != "ã™ã¹ã¦":
    filtered = filtered[filtered["åœ°åŸŸ"] == selected_area]
if selected_layout != "ã™ã¹ã¦":
    filtered = filtered[filtered["é–“å–ã‚Š"] == selected_layout]
if selected_usage != "ã™ã¹ã¦":
    filtered = filtered[filtered["ä½¿ç”¨ç›®çš„"] == selected_usage]
filtered = filtered[filtered["ä¾¡æ ¼"] <= max_price]
if selected_features:
    filtered = filtered[filtered["è¨­å‚™æ¡ä»¶"].apply(lambda x: all(f in x for f in selected_features))]

# çµæœè¡¨ç¤º
st.subheader(f"ğŸ” {len(filtered)} ä»¶ã®ç‰©ä»¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ")

for _, row in filtered.iterrows():
    with st.expander(f"{row['åœ°åŸŸ']} | {row['é–“å–ã‚Š']} | {row['ä¾¡æ ¼']}ä¸‡å††"):
        st.image(row["ç”»åƒURL"], caption="ç‰©ä»¶ã®å¤–è¦³", use_container_width=True)
        st.write(f"ğŸ  ç¯‰å¹´æ•°ï¼š{row['ç¯‰å¹´æ•°']}å¹´")
        st.write(f"ğŸ“‹ è©³ç´°ï¼š{row['è©³ç´°']}")
        st.write(f"ğŸ¯ ä½¿ç”¨ç›®çš„ï¼š{row['ä½¿ç”¨ç›®çš„']}")
        st.write(f"ğŸ”§ è¨­å‚™æ¡ä»¶ï¼š{', '.join(row['è¨­å‚™æ¡ä»¶'])}")
        st.button("ğŸ“© ãŠå•ã„åˆã‚ã›", key=f"contact_{row['ç‰©ä»¶ID']}")